Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

Install the latest PowerShell for new features and improvements! https://aka.ms/PSWindows

PS C:\Users\alexa> iex (irm "https://raw.githubusercontent.com/wizzense/AitherZero/main/bootstrap.ps1")

Select AitherZero Profile:
  [1] Minimal (5-8 MB) - Core infrastructure deployment only
  [2] Standard (15-25 MB) - Production-ready automation (recommended)
  [3] Development (35-50 MB) - Complete contributor environment

Enter your choice (1/2/3) [default: 2]:



Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

Install the latest PowerShell for new features and improvements! https://aka.ms/PSWindows

PS C:\Users\alexa> powershell.exe -command "iex (irm "https://raw.githubusercontent.com/wizzense/AitherZero/main/bootstrap.ps1")"
irm : Unable to read data from the transport connection: An established connection was aborted by the software in your
host machine.
At line:1 char:6
+ iex (irm  https://raw.githubusercontent.com/wizzense/AitherZero/main/ ...
+      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: (:) [Invoke-RestMethod], IOException
    + FullyQualifiedErrorId : System.IO.IOException,Microsoft.PowerShell.Commands.InvokeRestMethodCommand

PS C:\Users\alexa>






lost / spotty internet:

Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

Install the latest PowerShell for new features and improvements! https://aka.ms/PSWindows

PS C:\Users\alexa> iex (irm "https://raw.githubusercontent.com/wizzense/AitherZero/main/bootstrap.ps1")

Select AitherZero Profile:
  [1] Minimal (5-8 MB) - Core infrastructure deployment only
  [2] Standard (15-25 MB) - Production-ready automation (recommended)
  [3] Development (35-50 MB) - Complete contributor environment

Enter your choice (1/2/3) [default: 2]: 2
>> Downloading AitherZero (standard profile)...
[!] Installation failed: The remote name could not be resolved: 'api.github.com'
[i] Try manual download from: https://github.com/wizzense/AitherZero/releases

[process exited with code 1 (0x00000001)]
You can now close this terminal with Ctrl+D, or press Enter to restart.





PS C:\Users\alexa> powershell.exe -command "iex (irm "https://raw.githubusercontent.com/wizzense/AitherZero/main/bootstrap.ps1")"

Select AitherZero Profile:
  [1] Minimal (5-8 MB) - Core infrastructure deployment only
  [2] Standard (15-25 MB) - Production-ready automation (recommended)
  [3] Development (35-50 MB) - Complete contributor environment

Enter your choice (1/2/3) [default: 2]:
>> Downloading AitherZero (standard profile)...
[!] Specific profile not found, looking for any Windows package...
[*] Found release: aitherzero-full-windows-latest.zip
[-] Downloading aitherzero-full-windows-latest.zip...
[~] Extracting...




need to handle this, or at least handle it better. if running without powershell.exe -command, the window will abruptly close before able to catch this error: 

Windows PowerShell
Copyright (C) Microsoft Corporation. All rights reserved.

Install the latest PowerShell for new features and improvements! https://aka.ms/PSWindows

PS C:\Users\alexa> powershell.exe -command "iex (irm "https://raw.githubusercontent.com/wizzense/AitherZero/main/bootstrap.ps1")"

Select AitherZero Profile:
  [1] Minimal (5-8 MB) - Core infrastructure deployment only
  [2] Standard (15-25 MB) - Production-ready automation (recommended)
  [3] Development (35-50 MB) - Complete contributor environment

Enter your choice (1/2/3) [default: 2]:
>> Downloading AitherZero (standard profile)...
[!] Specific profile not found, looking for any Windows package...
[*] Found release: aitherzero-full-windows-latest.zip
[-] Downloading aitherzero-full-windows-latest.zip...
[~] Extracting...
[+] Extracted to: C:\Users\alexa
[i] Profile: standard
>> Starting AitherZero (standard profile)...
[~] Working directory: C:\Users\alexa
[~] Starting from: C:\Users\alexa
[!] Installation failed: File C:\Users\alexa\Start-AitherZero.ps1 cannot be loaded because running scripts is disabled on this system. For more information, see about_Execution_Policies at https:/go.microsoft.com/fwlink/?LinkID=135170.
[i] Try manual download from: https://github.com/wizzense/AitherZero/releases
PS C:\Users\alexa>




when not running as admin and trying to manually set execution policy:

PS C:\Users\alexa> set-executionpolicy bypass | powershell.exe  -command "iex (irm "https://raw.githubusercontent.com/wizzense/AitherZero/main/bootstrap.ps1")"
set-executionpolicy : Access to the registry key
'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\PowerShell\1\ShellIds\Microsoft.PowerShell' is denied. To change the execution
policy for the default (LocalMachine) scope, start Windows PowerShell with the "Run as administrator" option. To
change the execution policy for the current user, run "Set-ExecutionPolicy -Scope CurrentUser".
At line:1 char:1
+ set-executionpolicy bypass | powershell.exe  -command "iex (irm "http ...
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : PermissionDenied: (:) [Set-ExecutionPolicy], UnauthorizedAccessException
    + FullyQualifiedErrorId : System.UnauthorizedAccessException,Microsoft.PowerShell.Commands.SetExecutionPolicyComma
   nd
PS C:\Users\alexa>





need to handle this waaaaaaay better all of this is ugly.

PS C:\Windows\system32> set-executionpolicy bypass | powershell.exe  -command "iex (irm "https://raw.githubusercontent.com/wizzense/AitherZero/main/bootstrap.ps1")"

Execution Policy Change
The execution policy helps protect you from scripts that you do not trust. Changing the execution policy might expose
you to the security risks described in the about_Execution_Policies help topic at
https:/go.microsoft.com/fwlink/?LinkID=135170. Do you want to change the execution policy?
[Y] Yes  [A] Yes to All  [N] No  [L] No to All  [S] Suspend  [?] Help (default is "N"): a

Select AitherZero Profile:
  [1] Minimal (5-8 MB) - Core infrastructure deployment only
  [2] Standard (15-25 MB) - Production-ready automation (recommended)
  [3] Development (35-50 MB) - Complete contributor environment

Enter your choice (1/2/3) [default: 2]:
>> Downloading AitherZero (standard profile)...
[!] Specific profile not found, looking for any Windows package...
[*] Found release: aitherzero-full-windows-latest.zip
[-] Downloading aitherzero-full-windows-latest.zip...
[~] Extracting...
[+] Extracted to: C:\Windows\system32
[i] Profile: standard
>> Starting AitherZero (standard profile)...
[~] Working directory: C:\Windows\system32
[~] Starting from: C:\Windows\system32
AitherZero Infrastructure Automation Framework v0.6.10+

   Cross-Platform Infrastructure Automation with OpenTofu/Terraform

Loading AitherZero modules...
  âš ï¸  : The version of Windows PowerShell on this computer is '5.1.26100.4202'. The module 'C:\Windows\system32\aither-core\modules\AIToolsIntegration\AIToolsIntegration.psd1' requires a minimum Windows PowerShell version of '7.0' to run. Verify that you have the minimum required version of Windows PowerShell installed, and then try again.
  âš ï¸  : The version of Windows PowerShell on this computer is '5.1.26100.4202'. The module 'C:\Windows\system32\aither-core\modules\BackupManager\BackupManager.psd1' requires a minimum Windows PowerShell version of '7.0' to run. Verify that you have the minimum required version of Windows PowerShell installed, and then try again.
  âš ï¸  : The version of Windows PowerShell on this computer is '5.1.26100.4202'. The module 'C:\Windows\system32\aither-core\modules\ConfigurationCarousel\ConfigurationCarousel.psd1' requires a minimum Windows PowerShell version of '7.0' to run. Verify that you have the minimum required version of Windows PowerShell installed, and then try again.
  âš ï¸  : The version of Windows PowerShell on this computer is '5.1.26100.4202'. The module 'C:\Windows\system32\aither-core\modules\ConfigurationCore\ConfigurationCore.psd1' requires a minimum Windows PowerShell version of '7.0' to run. Verify that you have the minimum required version of Windows PowerShell installed, and then try again.
  âš ï¸  : The version of Windows PowerShell on this computer is '5.1.26100.4202'. The module 'C:\Windows\system32\aither-core\modules\ConfigurationRepository\ConfigurationRepository.psd1' requires a minimum Windows PowerShell version of '7.0' to run. Verify that you have the minimum required version of Windows PowerShell installed, and then try again.
  âš ï¸  : The version of Windows PowerShell on this computer is '5.1.26100.4202'. The module 'C:\Windows\system32\aither-core\modules\DevEnvironment\DevEnvironment.psd1' requires a minimum Windows PowerShell version of '7.0' to run. Verify that you have the minimum required version of Windows PowerShell installed, and then try again.
  âš ï¸  : The version of Windows PowerShell on this computer is '5.1.26100.4202'. The module 'C:\Windows\system32\aither-core\modules\ISOCustomizer\ISOCustomizer.psd1' requires a minimum Windows PowerShell version of '7.0' to run. Verify that you have the minimum required version of Windows PowerShell installed, and then try again.
  âš ï¸  : The version of Windows PowerShell on this computer is '5.1.26100.4202'. The module 'C:\Windows\system32\aither-core\modules\ISOManager\ISOManager.psd1' requires a minimum Windows PowerShell version of '7.0' to run. Verify that you have the minimum required version of Windows PowerShell installed, and then try again.
  âš ï¸  : The script 'LabRunner.psm1' cannot be run because it contained a "#requires" statement for Windows PowerShell 7.0. The version of Windows PowerShell that is required by the script does not match the currently running version of Windows PowerShell 5.1.26100.4202.
  âš ï¸  : The version of Windows PowerShell on this computer is '5.1.26100.4202'. The module 'C:\Windows\system32\aither-core\modules\Logging\Logging.psd1' requires a minimum Windows PowerShell version of '7.0' to run. Verify that you have the minimum required version of Windows PowerShell installed, and then try again.
  âš ï¸  : The version of Windows PowerShell on this computer is '5.1.26100.4202'. The module 'C:\Windows\system32\aither-core\modules\ModuleCommunication\ModuleCommunication.psd1' requires a minimum Windows PowerShell version of '7.0' to run. Verify that you have the minimum required version of Windows PowerShell installed, and then try again.
  âš ï¸  : The version of Windows PowerShell on this computer is '5.1.26100.4202'. The module 'C:\Windows\system32\aither-core\modules\OpenTofuProvider\OpenTofuProvider.psd1' requires a minimum Windows PowerShell version of '7.0' to run. Verify that you have the minimum required version of Windows PowerShell installed, and then try again.
  âš ï¸  : The version of Windows PowerShell on this computer is '5.1.26100.4202'. The module 'C:\Windows\system32\aither-core\modules\OrchestrationEngine\OrchestrationEngine.psd1' requires a minimum Windows PowerShell version of '7.0' to run. Verify that you have the minimum required version of Windows PowerShell installed, and then try again.
  âš ï¸  : The version of Windows PowerShell on this computer is '5.1.26100.4202'. The module 'C:\Windows\system32\aither-core\modules\ParallelExecution\ParallelExecution.psd1' requires a minimum Windows PowerShell version of '7.0' to run. Verify that you have the minimum required version of Windows PowerShell installed, and then try again.
  âš ï¸  : The version of Windows PowerShell on this computer is '5.1.26100.4202'. The module 'C:\Windows\system32\aither-core\modules\PatchManager\PatchManager.psd1' requires a minimum Windows PowerShell version of '7.0' to run. Verify that you have the minimum required version of Windows PowerShell installed, and then try again.
  âš ï¸  : The version of Windows PowerShell on this computer is '5.1.26100.4202'. The module 'C:\Windows\system32\aither-core\modules\ProgressTracking\ProgressTracking.psd1' requires a minimum Windows PowerShell version of '7.0' to run. Verify that you have the minimum required version of Windows PowerShell installed, and then try again.
  âš ï¸  : The version of Windows PowerShell on this computer is '5.1.26100.4202'. The module 'C:\Windows\system32\aither-core\modules\RemoteConnection\RemoteConnection.psd1' requires a minimum Windows PowerShell version of '7.0' to run. Verify that you have the minimum required version of Windows PowerShell installed, and then try again.
  âš ï¸  : The version of Windows PowerShell on this computer is '5.1.26100.4202'. The module 'C:\Windows\system32\aither-core\modules\RepoSync\RepoSync.psd1' requires a minimum Windows PowerShell version of '7.0' to run. Verify that you have the minimum required version of Windows PowerShell installed, and then try again.
  âš ï¸  : The version of Windows PowerShell on this computer is '5.1.26100.4202'. The module 'C:\Windows\system32\aither-core\modules\RestAPIServer\RestAPIServer.psd1' requires a minimum Windows PowerShell version of '7.0' to run. Verify that you have the minimum required version of Windows PowerShell installed, and then try again.
  âš ï¸  : The version of Windows PowerShell on this computer is '5.1.26100.4202'. The module 'C:\Windows\system32\aither-core\modules\ScriptManager\ScriptManager.psd1' requires a minimum Windows PowerShell version of '7.0' to run. Verify that you have the minimum required version of Windows PowerShell installed, and then try again.
  âš ï¸  : The version of Windows PowerShell on this computer is '5.1.26100.4202'. The module 'C:\Windows\system32\aither-core\modules\SecureCredentials\SecureCredentials.psd1' requires a minimum Windows PowerShell version of '7.0' to run. Verify that you have the minimum required version of Windows PowerShell installed, and then try again.
  âš ï¸  : The version of Windows PowerShell on this computer is '5.1.26100.4202'. The module 'C:\Windows\system32\aither-core\modules\SecurityAutomation\SecurityAutomation.psd1' requires a minimum Windows PowerShell version of '7.0' to run. Verify that you have the minimum required version of Windows PowerShell installed, and then try again.
  âš ï¸  : The running command stopped because the preference variable "ErrorActionPreference" or common parameter is set to Stop: At C:\Windows\system32\aither-core\modules\SetupWizard\SetupWizard.psm1:116 char:10
+         }
+          ~
The hash literal was incomplete.

At C:\Windows\system32\aither-core\modules\SetupWizard\SetupWizard.psm1:117 char:9
+         Architecture = [System.Runtime.InteropServices.RuntimeInforma ...
+         ~~~~~~~~~~~~
Unexpected token 'Architecture' in expression or statement.

At C:\Windows\system32\aither-core\modules\SetupWizard\SetupWizard.psm1:120 char:1
+ }
+ ~
Unexpected token '}' in expression or statement.

At C:\Windows\system32\aither-core\modules\SetupWizard\SetupWizard.psm1:308 char:76
+ ... on = tofu version 2>&1 | Select-String -Pattern 'OpenTofu v([\d.]+)'  ...
+                                                                  ~
Missing type name after '['.

At C:\Windows\system32\aither-core\modules\SetupWizard\SetupWizard.psm1:312 char:82
+ ... erraform version 2>&1 | Select-String -Pattern 'Terraform v([\d.]+)'  ...
+                                                                  ~
Missing type name after '['.

At C:\Windows\system32\aither-core\modules\SetupWizard\SetupWizard.psm1:641 char:20
+         $guide += "`n- $($step.Name)"
+                    ~~~
Unexpected token '`n-' in expression or statement.

At C:\Windows\system32\aither-core\modules\SetupWizard\SetupWizard.psm1:807 char:17
+     $choices = '&Yes', '&No'
+                 ~
The ampersand (&) character is not allowed. The & operator is reserved for future use; wrap an ampersand in double quotation marks ("&") to pass it as part of a string.

At C:\Windows\system32\aither-core\modules\SetupWizard\SetupWizard.psm1:807 char:25
+     $choices = '&Yes', '&No'
+                         ~
The ampersand (&) character is not allowed. The & operator is reserved for future use; wrap an ampersand in double quotation marks ("&") to pass it as part of a string.

At C:\Windows\system32\aither-core\modules\SetupWizard\SetupWizard.psm1:1109 char:26
+     'Review-Configuration'
+                          ~
The string is missing the terminator: '.

At C:\Windows\system32\aither-core\modules\SetupWizard\SetupWizard.psm1:122 char:27
+ function Show-SetupBanner {
+                           ~
Missing closing '}' in statement block or type definition.
  âš ï¸  : The version of Windows PowerShell on this computer is '5.1.26100.4202'. The module 'C:\Windows\system32\aither-core\modules\StartupExperience\StartupExperience.psd1' requires a minimum Windows PowerShell version of '7.0' to run. Verify that you have the minimum required version of Windows PowerShell installed, and then try again.
  âš ï¸  : The version of Windows PowerShell on this computer is '5.1.26100.4202'. The module 'C:\Windows\system32\aither-core\modules\SystemMonitoring\SystemMonitoring.psd1' requires a minimum Windows PowerShell version of '7.0' to run. Verify that you have the minimum required version of Windows PowerShell installed, and then try again.
  âš ï¸  : The version of Windows PowerShell on this computer is '5.1.26100.4202'. The module 'C:\Windows\system32\aither-core\modules\TestingFramework\TestingFramework.psd1' requires a minimum Windows PowerShell version of '7.0' to run. Verify that you have the minimum required version of Windows PowerShell installed, and then try again.
  âš ï¸  : The version of Windows PowerShell on this computer is '5.1.26100.4202'. The module 'C:\Windows\system32\aither-core\modules\UnifiedMaintenance\UnifiedMaintenance.psd1' requires a minimum Windows PowerShell version of '7.0' to run. Verify that you have the minimum required version of Windows PowerShell installed, and then try again.
Loaded 0/27 modules successfully
Starting AitherZero core application...

âš ï¸  PowerShell 5 detected - using compatibility bootstrap...
   The bootstrap will ensure optimal PowerShell 7+ compatibility.

â„¹ï¸ AitherZero Bootstrap v1.0 - Ensuring PowerShell 7+ Compatibility

âš ï¸ PowerShell 5.1.26100.4202 detected - Enhanced features require PowerShell 7+

â„¹ï¸ PowerShell 5.1.26100.4202 detected. Installing PowerShell 7 for optimal compatibility...
â„¹ï¸ This is a one-time setup process.

â„¹ï¸ Attempting installation via winget...
âœ… PowerShell 7 installed successfully via winget!

âœ… PowerShell 7 installation complete!
â„¹ï¸ You may need to restart your terminal for the changes to take effect.

âš ï¸ PowerShell 7 not detected. Attempting to run with current PowerShell version...
âš ï¸ Some features may be limited.

âŒ Bootstrap failed: The script 'aither-core.ps1' cannot be run because it contained a "#requires" statement for Windows PowerShell 7.0. The version of Windows PowerShell that is required by the script does not match the currently running version of Windows PowerShell 5.1.26100.4202.

Troubleshooting:
  1. Run as Administrator if installation failed
  2. Check internet connection for downloads
  3. Install PowerShell 7 manually: https://github.com/PowerShell/PowerShell/releases
  4. Restart terminal after manual installation


Error running AitherZero: Bootstrap script exited with code: 1

Troubleshooting Steps:
  1. Try setup mode: ./Start-AitherZero.ps1 -Setup
  2. Get help: ./Start-AitherZero.ps1 -Help
  3. Check PowerShell version: $PSVersionTable.PSVersion
  4. Ensure all files extracted properly

For automatic PowerShell 7 installation and full compatibility:
   Try the bootstrap script: aither-core/aither-core-bootstrap.ps1

   Or install PowerShell 7 manually:
   - Download: https://aka.ms/powershell-release-windows
   - winget: winget install Microsoft.PowerShell
   - chocolatey: choco install powershell-core

PS C:\Windows\system32>
PS C:\Windows\system32>

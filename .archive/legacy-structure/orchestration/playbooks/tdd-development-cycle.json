{
  "name": "tdd-development-cycle",
  "description": "Enforces Test-Driven Development with automatic reporting and quality checks",
  "version": "1.0",
  "author": "AitherZero DevOps Team",
  "options": {
    "enforceTestFirst": true,
    "autoGenerateReports": true,
    "blockOnFailure": true,
    "profiles": {
      "strict": {
        "description": "Strict TDD enforcement - blocks all commits without tests",
        "variables": {
          "RequireTestCoverage": 80,
          "BlockUntested": true,
          "AutoRevert": true
        }
      },
      "standard": {
        "description": "Standard TDD - warns on missing tests",
        "variables": {
          "RequireTestCoverage": 60,
          "BlockUntested": false,
          "AutoRevert": false
        }
      },
      "learning": {
        "description": "Learning mode - guides through TDD process",
        "variables": {
          "RequireTestCoverage": 40,
          "BlockUntested": false,
          "ShowGuidance": true
        }
      }
    }
  },
  "stages": [
    {
      "name": "Pre-Development",
      "description": "Ensure clean environment and latest reports",
      "sequence": ["0500", "0510"],
      "variables": {
        "Format": "All",
        "ShowMetrics": true
      },
      "continueOnError": false
    },
    {
      "name": "Write Tests First",
      "description": "TDD Step 1: Write failing tests",
      "sequence": ["0411"],
      "variables": {
        "ExpectFailure": true,
        "TestType": "Unit"
      },
      "validation": {
        "requireNewTests": true,
        "minimumTests": 1
      }
    },
    {
      "name": "Code Implementation",
      "description": "TDD Step 2: Write code to pass tests",
      "sequence": ["0407"],
      "variables": {
        "ValidateSyntax": true
      },
      "hooks": {
        "pre": "Verify tests exist",
        "post": "Check test results"
      }
    },
    {
      "name": "Run Test Suite",
      "description": "TDD Step 3: Verify all tests pass",
      "sequence": ["0402", "0403", "0411"],
      "variables": {
        "CoverageThreshold": "{{RequireTestCoverage:=60}}",
        "FailOnUncovered": "{{BlockUntested:=false}}"
      },
      "parallel": false,
      "continueOnError": false
    },
    {
      "name": "Quality Analysis",
      "description": "Run comprehensive quality checks",
      "sequence": ["0404", "0407", "0520", "0521"],
      "variables": {
        "AutoFix": true,
        "GenerateReport": true
      },
      "parallel": true
    },
    {
      "name": "Generate Reports",
      "description": "Create comprehensive development reports",
      "sequence": ["0510", "0511", "0522"],
      "variables": {
        "Format": "All",
        "IncludeCoverage": true,
        "IncludeMetrics": true,
        "ShowDashboard": true
      }
    },
    {
      "name": "AI Review",
      "description": "AI-assisted code review and suggestions",
      "sequence": ["0720", "0721"],
      "variables": {
        "ReviewType": "Comprehensive",
        "SuggestImprovements": true
      }
    },
    {
      "name": "Commit Preparation",
      "description": "Prepare changes for commit with validation",
      "sequence": ["0702"],
      "variables": {
        "ConventionalCommit": true,
        "IncludeTestResults": true
      },
      "validation": {
        "requirePassingTests": true,
        "requireMinCoverage": "{{RequireTestCoverage}}"
      }
    }
  ],
  "triggers": {
    "onFileChange": {
      "patterns": ["*.ps1", "*.psm1"],
      "stages": ["Write Tests First", "Run Test Suite"]
    },
    "onTestChange": {
      "patterns": ["*.Tests.ps1"],
      "stages": ["Run Test Suite", "Generate Reports"]
    },
    "preCommit": {
      "stages": ["Run Test Suite", "Quality Analysis"]
    },
    "postCommit": {
      "stages": ["Generate Reports"]
    },
    "schedule": {
      "daily": {
        "time": "09:00",
        "stages": ["Pre-Development", "Generate Reports"]
      },
      "onDemand": {
        "command": "seq tdd",
        "stages": ["all"]
      }
    }
  },
  "notifications": {
    "onTestFailure": {
      "log": "Tests failed - TDD cycle incomplete",
      "level": "Error",
      "blockCommit": "{{BlockUntested}}"
    },
    "onCoverageBelow": {
      "log": "Coverage below threshold: {{RequireTestCoverage}}%",
      "level": "Warning"
    },
    "onSuccess": {
      "log": "TDD cycle completed successfully",
      "level": "Success",
      "generateBadge": true
    }
  },
  "integrations": {
    "claudeCode": {
      "enabled": true,
      "autoSuggestTests": true,
      "reviewBeforeCommit": true
    },
    "github": {
      "enabled": true,
      "requireChecks": ["tests", "coverage", "analysis"],
      "protectBranch": true
    },
    "reporting": {
      "enabled": true,
      "formats": ["HTML", "JSON", "Markdown"],
      "publishTo": "tests/reports",
      "retentionDays": 30
    }
  },
  "enforcement": {
    "rules": [
      {
        "name": "TestsFirst",
        "description": "Tests must be written before code",
        "condition": "NewCode && !NewTests",
        "action": "Block",
        "message": "TDD requires tests to be written first"
      },
      {
        "name": "MinimumCoverage",
        "description": "Maintain minimum code coverage",
        "condition": "Coverage < {{RequireTestCoverage}}",
        "action": "Warn",
        "message": "Coverage is below required threshold"
      },
      {
        "name": "NoSkippedTests",
        "description": "All tests must run",
        "condition": "SkippedTests > 0",
        "action": "Warn",
        "message": "Skipped tests detected"
      }
    ]
  }
}
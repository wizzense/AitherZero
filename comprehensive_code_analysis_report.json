{
  "psscriptanalyzer": {
    "total_violations": 4700,
    "error_count": 271,
    "warning_count": 1094,
    "information_count": 3335,
    "top_violations": [
      {
        "name": "PSUseOutputTypeCorrectly",
        "count": 3335,
        "severity": "Information",
        "description": "Functions should specify output type"
      },
      {
        "name": "PSUseDeclaredVarsMoreThanAssignments",
        "count": 549,
        "severity": "Warning",
        "description": "Variables declared but not used effectively"
      },
      {
        "name": "PSAvoidAssignmentToAutomaticVariable",
        "count": 284,
        "severity": "Warning",
        "description": "Avoid assigning values to automatic variables"
      },
      {
        "name": "PSUseBOMForUnicodeEncodedFile",
        "count": 199,
        "severity": "Warning",
        "description": "Unicode files should have BOM"
      },
      {
        "name": "PSAvoidUsingEmptyCatchBlock",
        "count": 89,
        "severity": "Warning",
        "description": "Empty catch blocks should be avoided"
      },
      {
        "name": "PSAvoidOverwritingBuiltInCmdlets",
        "count": 87,
        "severity": "Warning",
        "description": "Avoid overwriting built-in cmdlets"
      },
      {
        "name": "PSAvoidUsingConvertToSecureStringWithPlainText",
        "count": 73,
        "severity": "Warning",
        "description": "Avoid using ConvertTo-SecureString with plain text"
      },
      {
        "name": "PSAvoidDefaultValueSwitchParameter",
        "count": 43,
        "severity": "Information",
        "description": "Switch parameters should not have default values"
      },
      {
        "name": "PSAvoidUsingWMICmdlet",
        "count": 15,
        "severity": "Warning",
        "description": "WMI cmdlets are deprecated"
      },
      {
        "name": "PSAvoidUsingPlainTextForPassword",
        "count": 12,
        "severity": "Error",
        "description": "Avoid using plain text for passwords"
      }
    ],
    "files_with_violations": [
      {
        "file": "ConnectionHelpers.ps1",
        "violations": 50
      },
      {
        "file": "Restore-BackupData.ps1",
        "violations": 39
      },
      {
        "file": "TestingFramework.psm1",
        "violations": 39
      },
      {
        "file": "Invoke-ValidationFailureHandler.ps1",
        "violations": 38
      },
      {
        "file": "AIToolsIntegration.psm1",
        "violations": 37
      }
    ],
    "clean_files": []
  },
  "code_quality": {
    "overall_score": 0.0,
    "average_complexity": 46.41,
    "total_files": 1286,
    "high_complexity_files": 823,
    "complexity_issues": [
      {
        "file": "TestingFramework.psm1",
        "complexity_score": 365.36,
        "lines": 2443,
        "functions": 59
      },
      {
        "file": "SetupWizard.psm1",
        "complexity_score": 335.88,
        "lines": 1894,
        "functions": 35
      },
      {
        "file": "Generate-ComprehensiveReport.ps1",
        "complexity_score": 273.76,
        "lines": 1688,
        "functions": 15
      },
      {
        "file": "AIToolsIntegration.psm1",
        "complexity_score": 261.30,
        "lines": 1565,
        "functions": 27
      },
      {
        "file": "LabRunner.psm1",
        "complexity_score": 245.74,
        "lines": 1137,
        "functions": 20
      }
    ],
    "duplication_found": [
      {
        "function_name": "not",
        "occurrences": 15,
        "files": ["Run-CI-Tests.ps1", "SetupWizard-Integration.Tests.ps1", "aither-core.ps1"]
      },
      {
        "function_name": "-Module",
        "occurrences": 7,
        "files": ["TestingFramework.Tests.ps1", "ConfigurationCarousel.Enhanced.Tests.ps1"]
      },
      {
        "function_name": "-",
        "occurrences": 4,
        "files": ["create-ps7-pr.ps1", "Invoke-AutomatedErrorTracking.ps1", "TestingFramework.psm1"]
      }
    ],
    "long_functions": 1011,
    "maintainability_score": 15.84,
    "technical_debt_areas": [
      "High number of duplicate function names (327)",
      "Multiple long functions (>100 lines) detected (1011)",
      "High average complexity score (46.41)"
    ],
    "error_handling_coverage": 79.98
  },
  "security": {
    "security_score": 18.2,
    "total_findings": 739,
    "high_severity": 226,
    "medium_severity": 132,
    "low_severity": 381,
    "security_violations": [
      {
        "category": "Command Injection Risks",
        "count": 90,
        "files_affected": 43,
        "severity": "High",
        "description": "Use of Invoke-Expression, Start-Process, and similar commands"
      },
      {
        "category": "Hardcoded Passwords",
        "count": 85,
        "files_affected": 66,
        "severity": "High",
        "description": "Potential hardcoded passwords or secrets in code"
      },
      {
        "category": "Hardcoded Tokens",
        "count": 44,
        "files_affected": 10,
        "severity": "High",
        "description": "Hardcoded API keys or tokens"
      },
      {
        "category": "File System Risks",
        "count": 343,
        "files_affected": 130,
        "severity": "Medium",
        "description": "Potentially unsafe file system operations"
      },
      {
        "category": "Execution Policy Bypass",
        "count": 7,
        "files_affected": 4,
        "severity": "High",
        "description": "Attempts to bypass PowerShell execution policy"
      }
    ],
    "potential_vulnerabilities": [
      {
        "type": "Input Validation Gaps",
        "count": 326,
        "description": "User input without proper validation"
      },
      {
        "type": "Exception Details Exposure",
        "count": 15,
        "description": "Exception details exposed in output"
      }
    ],
    "credential_handling_issues": [],
    "input_validation_gaps": 326,
    "top_risk_files": [
      {
        "file": "New-AdvancedAutounattendFile.ps1",
        "issue_count": 26
      },
      {
        "file": "New-CustomISOWithProgress.ps1",
        "issue_count": 22
      },
      {
        "file": "New-CustomISO.ps1",
        "issue_count": 22
      },
      {
        "file": "New-AutounattendFile.ps1",
        "issue_count": 20
      },
      {
        "file": "Install-DevTools.ps1",
        "issue_count": 18
      }
    ]
  },
  "best_practices": {
    "compliance_score": 68.5,
    "approved_verbs_score": 100.0,
    "parameter_validation_score": 0.0,
    "help_documentation_score": 90.0,
    "cross_platform_score": 84.0,
    "approved_verbs_violations": 0,
    "parameter_validation_missing": 592,
    "help_documentation_missing": 122,
    "cross_platform_issues": 203,
    "manifest_issues": 3,
    "total_files_analyzed": 1282,
    "recommendations": [
      "Add help documentation to functions for better maintainability",
      "Address cross-platform compatibility issues for better portability",
      "Fix module manifest issues to ensure proper module loading"
    ]
  },
  "summary": {
    "overall_health_score": 23.6,
    "total_files_analyzed": 1286,
    "critical_issues": 497,
    "high_priority_actions": [
      "Fix 226 high-severity security violations immediately",
      "Reduce code complexity in 823 high-complexity files",
      "Address 592 parameter validation issues",
      "Implement input validation for 326 user input scenarios",
      "Add help documentation to 122 functions"
    ],
    "immediate_remediation_required": [
      "Command injection risks in 43 files",
      "Hardcoded passwords/secrets in 66 files",
      "Multiple long functions (>100 lines) in 1011 files",
      "Cross-platform compatibility issues in 203 files"
    ],
    "technical_debt_level": "CRITICAL",
    "maintainability_risk": "HIGH",
    "security_risk": "HIGH",
    "code_quality_grade": "D-",
    "recommendations_priority": {
      "immediate": [
        "Address all high-severity security violations",
        "Implement comprehensive input validation",
        "Remove hardcoded credentials and secrets"
      ],
      "short_term": [
        "Refactor complex functions to improve maintainability",
        "Add comprehensive help documentation",
        "Fix cross-platform compatibility issues"
      ],
      "long_term": [
        "Implement automated code quality gates",
        "Establish security scanning in CI/CD pipeline",
        "Create coding standards and review processes"
      ]
    }
  }
}
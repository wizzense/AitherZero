{
  "Name": "automated-security-review",
  "Description": "Comprehensive AI-powered security analysis and remediation",
  "Version": "1.0.0",
  "Author": "AitherZero Security Team",
  "Tags": ["ai", "security", "compliance", "vulnerability", "remediation"],
  "Requirements": {
    "MinimumPowerShellVersion": "7.0",
    "RequiredModules": ["AIWorkflowOrchestrator", "SecureCredentials"],
    "RequiredAPIKeys": ["ANTHROPIC_API_KEY"],
    "Permissions": ["ReadCode", "WriteRemediation", "CreateIssues"]
  },
  "Variables": {
    "ScanPath": ".",
    "ComplianceFrameworks": ["SOC2", "PCI-DSS", "HIPAA"],
    "RemediationEnabled": true,
    "CreateSecurityIssues": true,
    "BlockOnCritical": true
  },
  "Stages": [
    {
      "Name": "Vulnerability Scanning",
      "Description": "Deep scan for security vulnerabilities",
      "Scripts": ["0735"],
      "Variables": {
        "Path": "{{ScanPath}}",
        "ComplianceFramework": "All",
        "GenerateRemediation": true
      },
      "ContinueOnError": false,
      "Timeout": 900
    },
    {
      "Name": "Credential Exposure Check",
      "Description": "Scan for exposed credentials and secrets",
      "Scripts": ["0731"],
      "Variables": {
        "Path": "{{ScanPath}}",
        "Profile": "Comprehensive",
        "SkipPerformance": true,
        "SkipQuality": true
      },
      "ContinueOnError": false,
      "Timeout": 600
    },
    {
      "Name": "Threat Modeling",
      "Description": "AI-powered threat modeling and attack surface analysis",
      "Scripts": ["0736"],
      "Variables": {
        "Requirements": "Perform threat modeling for {{ScanPath}}",
        "WorkflowType": "Custom",
        "OutputPath": "./threat-model.json"
      },
      "ContinueOnError": true,
      "Timeout": 600
    },
    {
      "Name": "Compliance Validation",
      "Description": "Validate against compliance frameworks",
      "Scripts": ["0735"],
      "Variables": {
        "Path": "{{ScanPath}}",
        "ComplianceFramework": "{{ComplianceFrameworks}}",
        "GenerateRemediation": false
      },
      "Parallel": true,
      "ContinueOnError": true,
      "Timeout": 900
    },
    {
      "Name": "Generate Remediation",
      "Description": "Create remediation scripts and patches",
      "Scripts": ["0736", "0733"],
      "Variables": {
        "Requirements": "Generate security remediation for identified vulnerabilities",
        "WorkflowType": "Custom",
        "DocType": "README",
        "OutputPath": "./remediation"
      },
      "Condition": "{{RemediationEnabled}}",
      "ContinueOnError": true,
      "Timeout": 600
    },
    {
      "Name": "Remediation Validation",
      "Description": "Validate remediation scripts before execution",
      "Scripts": ["0739"],
      "Variables": {
        "Path": "./remediation",
        "ValidationType": "All",
        "StrictMode": true
      },
      "Condition": "{{RemediationEnabled}}",
      "ContinueOnError": false,
      "Timeout": 300
    },
    {
      "Name": "Security Report",
      "Description": "Generate comprehensive security report",
      "Scripts": ["0733"],
      "Variables": {
        "Path": "{{ScanPath}}",
        "DocType": "API",
        "OutputPath": "./security-report"
      },
      "ContinueOnError": true,
      "Timeout": 300
    },
    {
      "Name": "Create Issues",
      "Description": "Create GitHub issues for security findings",
      "Scripts": ["0701"],
      "Variables": {
        "Type": "security",
        "Name": "security-findings-{{date}}"
      },
      "Condition": "{{CreateSecurityIssues}}",
      "ContinueOnError": true,
      "Timeout": 180
    }
  ],
  "Thresholds": {
    "Critical": {
      "MaxCount": 0,
      "Action": "block",
      "Notification": "immediate"
    },
    "High": {
      "MaxCount": 5,
      "Action": "warn",
      "Notification": "summary"
    },
    "Medium": {
      "MaxCount": 20,
      "Action": "log",
      "Notification": "report"
    }
  },
  "Remediation": {
    "AutoApply": false,
    "RequireApproval": true,
    "TestBeforeApply": true,
    "RollbackEnabled": true
  },
  "Reporting": {
    "Format": ["HTML", "JSON", "Markdown"],
    "IncludeRemediation": true,
    "IncludeCompliance": true,
    "IncludeThreatModel": true
  }
}
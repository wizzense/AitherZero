{
  "metadata": {
    "name": "vulnerability-scan",
    "description": "Comprehensive security vulnerability scanning and remediation",
    "version": "2.0.0",
    "category": "security", 
    "author": "AitherZero Security Team",
    "tags": ["security", "vulnerability", "scanning", "compliance", "ai"],
    "estimatedDuration": "15-25 minutes",
    "lastUpdated": "2025-10-26T22:25:00Z"
  },
  "requirements": {
    "minimumPowerShellVersion": "7.0",
    "requiredModules": ["AIWorkflowOrchestrator", "SecureCredentials"],
    "requiredTools": [],
    "platforms": ["CrossPlatform"],
    "permissions": ["ReadCode", "WriteReports", "CreateIssues"],
    "apiKeys": ["ANTHROPIC_API_KEY"]
  },
  "orchestration": {
    "defaultVariables": {
      "ScanPath": ".",
      "ComplianceFrameworks": ["SOC2", "PCI-DSS"],
      "RemediationEnabled": true,
      "AutoCreateIssues": true,
      "BlockOnCritical": true
    },
    "profiles": {
      "quick": {
        "description": "Fast security scan for development",
        "variables": {
          "ComplianceFrameworks": ["Basic"],
          "RemediationEnabled": false,
          "AutoCreateIssues": false,
          "SkipThreatModel": true
        }
      },
      "comprehensive": {
        "description": "Full security audit with remediation",
        "variables": {
          "ComplianceFrameworks": ["SOC2", "PCI-DSS", "HIPAA"],
          "RemediationEnabled": true,
          "AutoCreateIssues": true,
          "IncludeThreatModel": true
        }
      },
      "compliance": {
        "description": "Compliance-focused security scan",
        "variables": {
          "ComplianceFrameworks": ["SOC2", "ISO27001"],
          "RemediationEnabled": false,
          "AutoCreateIssues": true,
          "FocusCompliance": true
        }
      }
    },
    "stages": [
      {
        "name": "Security Vulnerability Scan",
        "description": "AI-powered vulnerability detection",
        "sequences": ["0735"],
        "variables": {
          "Path": "{{ScanPath}}",
          "ComplianceFramework": "All",
          "GenerateRemediation": "{{RemediationEnabled}}"
        },
        "continueOnError": false,
        "timeout": 900
      },
      {
        "name": "Credential Exposure Check", 
        "description": "Scan for exposed secrets and credentials",
        "sequences": ["0731"],
        "variables": {
          "Path": "{{ScanPath}}",
          "Profile": "Comprehensive",
          "SkipPerformance": true,
          "SkipQuality": true
        },
        "parallel": true,
        "continueOnError": false,
        "timeout": 600
      },
      {
        "name": "Threat Modeling",
        "description": "AI-powered threat analysis",
        "sequences": ["0736"],
        "condition": "-not $SkipThreatModel",
        "variables": {
          "Requirements": "Perform threat modeling for {{ScanPath}}",
          "WorkflowType": "Custom",
          "OutputPath": "./security/threat-model.json"
        },
        "continueOnError": true,
        "timeout": 600
      },
      {
        "name": "Compliance Validation",
        "description": "Validate against compliance frameworks",
        "sequences": ["0735"],
        "variables": {
          "Path": "{{ScanPath}}",
          "ComplianceFramework": "{{ComplianceFrameworks}}",
          "GenerateRemediation": false,
          "FocusMode": "{{FocusCompliance:=false}}"
        },
        "parallel": true,
        "continueOnError": true,
        "timeout": 900
      },
      {
        "name": "Remediation Generation",
        "description": "Generate automated security fixes",
        "sequences": ["0736", "0733"],
        "condition": "$RemediationEnabled",
        "variables": {
          "Requirements": "Generate security remediation for identified vulnerabilities",
          "WorkflowType": "Custom",
          "DocType": "README",
          "OutputPath": "./security/remediation"
        },
        "continueOnError": true,
        "timeout": 600
      },
      {
        "name": "Remediation Validation",
        "description": "Validate generated security fixes",
        "sequences": ["0739"],
        "condition": "$RemediationEnabled",
        "variables": {
          "Path": "./security/remediation",
          "ValidationType": "All",
          "StrictMode": true
        },
        "continueOnError": false,
        "timeout": 300
      },
      {
        "name": "Security Report Generation",
        "description": "Create comprehensive security report",
        "sequences": ["0733"],
        "variables": {
          "Path": "{{ScanPath}}",
          "DocType": "API",
          "OutputPath": "./security/reports"
        },
        "continueOnError": true,
        "timeout": 300
      },
      {
        "name": "Issue Creation",
        "description": "Create GitHub issues for findings",
        "sequences": ["0800"],
        "condition": "$AutoCreateIssues",
        "variables": {
          "IssueType": "security",
          "Severity": "high",
          "AssignToTeam": "security"
        },
        "continueOnError": true,
        "timeout": 300
      }
    ]
  },
  "validation": {
    "preConditions": [
      {
        "name": "AI API Available",
        "condition": "$env:ANTHROPIC_API_KEY -or $env:OPENAI_API_KEY",
        "message": "AI API key is required for security analysis"
      }
    ],
    "thresholds": {
      "Critical": {
        "maxCount": 0,
        "action": "fail"
      },
      "High": {
        "maxCount": 5,
        "action": "warn"
      },
      "Medium": {
        "maxCount": 20,
        "action": "continue"
      }
    }
  },
  "notifications": {
    "onStart": {
      "message": "üõ°Ô∏è Starting comprehensive security vulnerability scan...",
      "level": "Information"
    },
    "onSuccess": {
      "message": "‚úÖ Security scan completed. Review reports for findings.",
      "level": "Success"
    },
    "onFailure": {
      "message": "üö® Security scan failed or found critical vulnerabilities!",
      "level": "Error"
    },
    "onWarning": {
      "message": "‚ö†Ô∏è Security issues found. Review and address promptly.",
      "level": "Warning"
    }
  },
  "reporting": {
    "enabled": true,
    "formats": ["HTML", "JSON", "Markdown"],
    "outputPath": "./reports/security",
    "includeMetrics": true,
    "includeLogs": true
  }
}